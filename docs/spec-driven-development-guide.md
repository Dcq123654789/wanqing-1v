# 晚晴小程序 - Spec-Driven Development 工作指南

本文档针对**晚晴养老服务小程序**的特点，定制了简化的 Spec-Driven Development 工作流程。

---

## 为什么要用 Spec-Driven Development？

对于晚晴这类展示型应用，Spec-Driven Development 帮助我们：

1. **思考内容优先**：先想清楚要展示什么，再考虑怎么展示
2. **统一理解**：产品、设计、开发对功能有一致理解
3. **减少返工**：提前发现问题，避免开发到一半改需求
4. **便于沟通**：有文档可追溯，方便后续讨论

---

## 工作流程（简化版）

### 展示型应用不需要完整流程

晚晴是**内容展示 + 业务入口**型应用，不需要复杂的业务逻辑处理，因此流程可以简化：

```
Specify（描述内容）
    ↓
Plan（设计方案）
    ↓
Implement（直接实现）
```

**跳过**：
- ~~Clarify~~（展示内容相对直观）
- ~~Tasks~~（页面结构简单，不需要复杂任务分解）

---

## 流程详解

### 第一步：Specify（描述内容）

**目的**：明确要展示什么内容、什么功能

**命令**：`/speckit.specify`

**输入示例**：
```
/speckit.specify 在首页添加"敬老院推荐"模块：

展示 3 家推荐敬老院的信息卡片
每张卡片包含：
- 敬老院名称
- 封面图片
- 简介（50字以内）
- 价格（起）
- 标签（医养结合、失智照护等）

点击卡片跳转到详情页
使用虚拟数据，mock 3 条数据
```

**AI 输出**：`specs/XXX-feature-name/spec.md`

**包含内容**：
- 功能概述
- 展示内容清单
- 用户交互
- 数据需求

---

### 第二步：Plan（设计方案）

**目的**：设计页面结构和数据模型

**命令**：`/speckit.plan`

**输入示例**：
```
/speckit.plan
使用卡片式布局，封面图在上，信息在下
卡片间距 32rpx，圆角 16rpx
标题 36rpx，正文 28rpx
价格使用橙色（#ff9800）突出
点击使用 Taro.navigateTo 跳转详情
```

**AI 输出**：`specs/XXX-feature-name/plan.md`

**包含内容**：
- 页面布局设计
- 组件拆分方案
- 数据结构定义
- 样式规范

---

### 第三步：Implement（直接实现）

**目的**：根据方案快速开发

**命令**：`/speckit.implement`

**AI 会执行**：
1. 创建必要的文件（组件、页面、类型定义）
2. 编写 mock 数据
3. 实现页面逻辑
4. 添加样式

**开发者需要**：
1. 检查生成的代码
2. 调整细节（图片、文案等）
3. 测试功能
4. 提交代码

---

## 实际案例演示

### 案例：在首页添加"旅游线路推荐"模块

**Step 1: Specify（描述内容）**

```
/speckit.specify 在首页底部添加"精选旅游线路"模块：

- 标题：精选旅游（32rpx，橙色）
- 展示 4 条旅游线路
- 每条线路显示：
  * 线路名称（如"海南三亚 5 日游"）
  * 封面图片（16:9）
  * 价格（¥2999 起）
  * 标签（适合老年人、慢节奏等）

- 点击跳转到线路详情页
- 横向滑动查看更多
- 使用虚拟数据
```

**输出**：`specs/003-travel-recommend/spec.md`

---

**Step 2: Plan（设计方案）**

```
/speckit.plan
使用横向滚动布局
卡片宽度 600rpx，高度 400rpx
图片使用 mode="aspectFill"
价格用橙色，右下角显示
标题 32rpx，两行省略
使用 ScrollView 横向滚动
```

**输出**：`specs/003-travel-recommend/plan.md`

---

**Step 3: Implement（直接实现）**

```
/speckit.implement
```

**AI 生成**：
1. 更新 `src/pages/home/index.tsx` 添加模块
2. 创建 `TravelCard` 组件
3. 添加 mock 数据
4. 实现横向滚动

**开发者检查**：
- 图片是否正常显示
- 滚动是否流畅
- 点击跳转是否正确

---

## 常见场景模板

### 场景 1：添加新的业务分类

```
/speckit.specify 在"颐养"页面添加"康复理疗"分类：

展示 6 个康复项目：
- 物理理疗（推拿、针灸）
- 运动康复
- 言语训练
- 心理咨询
- 营养指导
- 健康管理

使用列表展示，配小图标
点击进入详情页
```

---

### 场景 2：优化现有页面

```
/speckit.specify 优化首页通知栏：

当前问题：文字太小，不醒目
改进方案：
- 标题放大到 32rpx
- 重要通知用红色标签标记
- 添加点击展开详情
- 滚动播放（自动播放）
```

---

### 场景 3：添加新功能页面

```
/speckit.specify 新增"服务预约"页面：

用户可以：
1. 选择服务类型（康复护理、陪同就医、生活照料）
2. 选择日期和时间
3. 填写联系信息
4. 提交预约

使用表单提交
预约成功后显示提示
数据暂时存储在本地
```

---

## 快速参考

| 命令 | 作用 | 何时使用 |
|------|------|----------|
| `/speckit.specify` | 描述内容和功能 | 开始新功能时 |
| `/speckit.plan` | 设计实现方案 | spec 完成后 |
| `/speckit.implement` | 生成代码 | plan 完成后 |
| `/speckit.constitution` | 更新项目原则 | 重大调整时 |

---

## 最佳实践

### ✅ 推荐做法

1. **Specify 阶段说清楚内容**
   - 要展示什么信息
   - 信息如何组织
   - 用户如何交互

2. **Plan 阶段考虑用户体验**
   - 字号是否够大
   - 按钮是否易点
   - 是否符合中老年习惯

3. **Implement 后及时测试**
   - 检查内容展示
   - 测试交互流程
   - 优化性能问题

### ❌ 避免做法

1. Specify 中讨论技术实现（应在 Plan）
2. 跳过 Specify 直接写代码
3. Plan 中不提字号、间距等细节
4. Implement 后不检查直接提交

---

## 与完整流程的区别

| 完整流程 | 晚晴简化版 |
|---------|-----------|
| 5 个阶段 | 3 个阶段 |
| 详细用户故事 | 简单内容描述 |
| 澄清细节 | 跳过（内容直观） |
| 任务分解 | 跳过（结构简单） |
| 强调可执行规格 | 强调快速实现 |

**为什么可以简化？**
- 展示型应用逻辑简单
- 内容直观，不需要反复澄清
- 页面结构清晰，不需要复杂任务分解

---

## 总结

晚晴小程序的 Spec-Driven Development 流程：

**核心**：想清楚要展示什么 → 设计怎么展示 → 快速实现

**关键**：
- Specify 阶段把内容说清楚
- Plan 阶段考虑中老年用户体验
- Implement 阶段注重细节

**价值**：
- 减少返工
- 保证质量
- 提升效率

---

**相关文档**：
- [项目 Constitution](../.specify/memory/constitution.md)
- [完整案例](./spec-workflow-example.md)
- [Taro 开发规范](../taro开发规范.md)
